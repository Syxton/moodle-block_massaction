define ("block_massaction/checkboxmanager",["exports","core/templates","core/notification","./massactionblock"],function(a,b,c,d){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;b=function(a){return a&&a.__esModule?a:{default:a}}(b);var e={},f=function(a,b){a.forEach(function(a){e[a.number]=[];var c=a.modules.split(",");if(c&&0<c.length&&""!==c[0]){var d=b.filter(function(a){return c.includes(a.modid.toString())});d.forEach(function(b){g(a.number,b.modid.toString(),b.name)})}})},g=function(a,b,c){var f=d.cssIds.BOX_ID_PREFIX+b,g=document.getElementById(d.usedMoodleCssClasses.MODULE_ID_PREFIX+b);if(null===document.getElementById(f)){var h=document.createElement("input");h.type="checkbox";h.className=d.cssIds.CHECKBOX_CLASS;h.id=f;if(null!==g){var i=c+d.constants.CHECKBOX_DESCRIPTION_SUFFIX;h.ariaLabel=i;h.name=i;g.insertBefore(h,g.firstChild)}}e[a].push({moduleId:b,boxId:f})},h=function(a){return a.filter(function(a){return a.modules.split(",").every(function(a){return null!==document.getElementById(d.usedMoodleCssClasses.MODULE_ID_PREFIX+a)})})},i=function(a,e){var f=Array.prototype.map.call(document.getElementById(d.cssIds.SECTION_SELECT).options,function(a){return a.text});f.shift();var g=JSON.stringify(e.map(function(a){return a.name}))!==JSON.stringify(f);if(g){b.default.renderForPromise("block_massaction/section_select",{sections:e}).then(function(c){var e=c.html,f=c.js;b.default.replaceNode("#"+d.cssIds.SECTION_SELECT,e,f);j(a);document.getElementById(d.cssIds.SECTION_SELECT).addEventListener("click",function(a){return(0,d.setSectionSelection)(!0,a.target.value)},!1);return!0}).catch(function(a){return(0,c.exception)(a)});b.default.renderForPromise("block_massaction/moveto_select",{sections:e}).then(function(a){var c=a.html,e=a.js;b.default.replaceNode("#"+d.cssIds.MOVETO_SELECT,c,e);return!0}).catch(function(a){return(0,c.exception)(a)});b.default.renderForPromise("block_massaction/duplicateto_select",{sections:e}).then(function(a){var c=a.html,e=a.js;b.default.replaceNode("#"+d.cssIds.DUPLICATETO_SELECT,c,e);return!0}).catch(function(a){return(0,c.exception)(a)})}else{j(a)}},j=function(a){Array.prototype.forEach.call(document.getElementById(d.cssIds.SECTION_SELECT).options,function(b){if(b.value!==d.constants.SECTION_SELECT_DESCRIPTION_VALUE&&!a.some(function(a){return parseInt(b.value)===a.number})){b.disabled=!0}else{b.disabled=!1}})};a.default=function checkboxmanager(a,b){var c=a;a=h(a);i(a,c);f(a,b);return e};return a.default});
//# sourceMappingURL=checkboxmanager.min.js.map
